<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MongoDB Cheat Sheet #3 - DDL (Data Definition Language)</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    .header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 15px;
    }
    .header h1 {
      font-size: 2em;
      margin-bottom: 10px;
      color: #fff;
    }
    .header .subtitle {
      color: #fff;
      font-size: 1.1em;
      opacity: 0.9;
    }
    .badge {
      display: inline-block;
      background: rgba(0,0,0,0.3);
      color: #fff;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.85em;
      margin-top: 10px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    .card {
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 20px;
      border: 1px solid rgba(255,255,255,0.1);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(102,126,234,0.3);
    }
    .card-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #667eea;
    }
    .card-icon {
      font-size: 1.8em;
      margin-right: 12px;
    }
    .card-title {
      font-size: 1.3em;
      color: #667eea;
    }
    .code-block {
      background: #0d1117;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.85em;
      overflow-x: auto;
      border-left: 3px solid #667eea;
    }
    .code-comment {
      color: #6a737d;
    }
    .code-keyword {
      color: #ff7b72;
    }
    .code-string {
      color: #a5d6ff;
    }
    .code-method {
      color: #d2a8ff;
    }
    .code-number {
      color: #79c0ff;
    }
    .code-bool {
      color: #ff7b72;
    }
    .code-prop {
      color: #7ee787;
    }
    .highlight {
      background: linear-gradient(135deg, rgba(102,126,234,0.2), rgba(118,75,162,0.2));
      padding: 15px;
      border-radius: 10px;
      margin: 10px 0;
    }
    .list-item {
      padding: 8px 0;
      padding-left: 20px;
      position: relative;
    }
    .list-item::before {
      content: "‚ñ∏";
      position: absolute;
      left: 0;
      color: #667eea;
    }
    .tag {
      display: inline-block;
      background: rgba(102,126,234,0.2);
      color: #667eea;
      padding: 3px 10px;
      border-radius: 5px;
      font-size: 0.8em;
      margin: 2px;
    }
    .tag-green {
      background: rgba(46,204,113,0.2);
      color: #2ecc71;
    }
    .tag-red {
      background: rgba(231,76,60,0.2);
      color: #e74c3c;
    }
    .tag-orange {
      background: rgba(243,156,18,0.2);
      color: #f39c12;
    }
    .tag-cyan {
      background: rgba(26,188,156,0.2);
      color: #1abc9c;
    }
    .tag-purple {
      background: rgba(155,89,182,0.2);
      color: #9b59b6;
    }
    .full-width {
      grid-column: 1 / -1;
    }
    .info-box {
      background: rgba(52,152,219,0.1);
      border-left: 3px solid #3498db;
      padding: 12px;
      border-radius: 0 8px 8px 0;
      margin: 10px 0;
      font-size: 0.9em;
    }
    .warning-box {
      background: rgba(231,76,60,0.1);
      border-left: 3px solid #e74c3c;
      padding: 12px;
      border-radius: 0 8px 8px 0;
      margin: 10px 0;
      font-size: 0.9em;
    }
    .tip-box {
      background: rgba(46,204,113,0.1);
      border-left: 3px solid #2ecc71;
      padding: 12px;
      border-radius: 0 8px 8px 0;
      margin: 10px 0;
      font-size: 0.9em;
    }
    .section-title {
      color: #667eea;
      font-size: 1.1em;
      margin: 15px 0 10px 0;
      padding-bottom: 5px;
      border-bottom: 1px dashed rgba(102,126,234,0.3);
    }
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
      font-size: 0.9em;
    }
    .comparison-table th, .comparison-table td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .comparison-table th {
      background: rgba(102,126,234,0.2);
      color: #667eea;
    }
    .comparison-table tr:hover {
      background: rgba(255,255,255,0.05);
    }
    .sql-mongo {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .sql-box {
      background: rgba(231,76,60,0.1);
      border-radius: 8px;
      padding: 10px;
      border-top: 3px solid #e74c3c;
    }
    .sql-box-title {
      color: #e74c3c;
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 0.85em;
    }
    .mongo-box {
      background: rgba(46,204,113,0.1);
      border-radius: 8px;
      padding: 10px;
      border-top: 3px solid #2ecc71;
    }
    .mongo-box-title {
      color: #2ecc71;
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 0.85em;
    }
    .mini-code {
      background: #0d1117;
      padding: 8px;
      border-radius: 5px;
      font-family: monospace;
      font-size: 0.8em;
      overflow-x: auto;
    }
    .flex-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px 0;
    }
    .schema-visual {
      background: #0d1117;
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
    }
    .footer {
      text-align: center;
      padding: 20px;
      color: rgba(255,255,255,0.5);
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>üçÉ MongoDB Cheat Sheet #3</h1>
      <div class="subtitle">DDL - Data Definition Language</div>
      <div class="badge">üèóÔ∏è Database & Collection Management</div>
    </div>

    <!-- SQL vs MongoDB DDL -->
    <div class="grid">
      <div class="card full-width">
        <div class="card-header">
          <span class="card-icon">üîÑ</span>
          <span class="card-title">So S√°nh: SQL DDL vs MongoDB DDL</span>
        </div>
        <table class="comparison-table">
          <tr>
            <th>SQL DDL</th>
            <th>MongoDB Equivalent</th>
            <th>Ghi ch√∫</th>
          </tr>
          <tr>
            <td><code>CREATE DATABASE</code></td>
            <td><code>use dbName</code></td>
            <td>T·ª± ƒë·ªông t·∫°o khi insert ƒë·∫ßu ti√™n</td>
          </tr>
          <tr>
            <td><code>DROP DATABASE</code></td>
            <td><code>db.dropDatabase()</code></td>
            <td>X√≥a to√†n b·ªô database</td>
          </tr>
          <tr>
            <td><code>CREATE TABLE</code></td>
            <td><code>db.createCollection()</code></td>
            <td>T√πy ch·ªçn - t·ª± ƒë·ªông t·∫°o khi insert</td>
          </tr>
          <tr>
            <td><code>DROP TABLE</code></td>
            <td><code>db.collection.drop()</code></td>
            <td>X√≥a collection v√† indexes</td>
          </tr>
          <tr>
            <td><code>TRUNCATE TABLE</code></td>
            <td><code>db.collection.deleteMany({})</code></td>
            <td>X√≥a t·∫•t c·∫£ documents, gi·ªØ collection</td>
          </tr>
          <tr>
            <td><code>ALTER TABLE</code></td>
            <td><span class="tag-orange tag">Kh√¥ng c·∫ßn</span></td>
            <td>Schema flexible - th√™m field t·ª± do</td>
          </tr>
          <tr>
            <td><code>RENAME TABLE</code></td>
            <td><code>db.collection.renameCollection()</code></td>
            <td>ƒê·ªïi t√™n collection</td>
          </tr>
          <tr>
            <td><code>CREATE INDEX</code></td>
            <td><code>db.collection.createIndex()</code></td>
            <td>T·∫°o index</td>
          </tr>
          <tr>
            <td><code>DROP INDEX</code></td>
            <td><code>db.collection.dropIndex()</code></td>
            <td>X√≥a index</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Database Operations -->
    <div class="grid">
      <div class="card">
        <div class="card-header">
          <span class="card-icon">üóÑÔ∏è</span>
          <span class="card-title">Database Operations</span>
        </div>
        
        <div class="section-title">üìã Xem Databases</div>
        <div class="code-block">
          <span class="code-comment">// Li·ªát k√™ t·∫•t c·∫£ databases</span><br>
          <span class="code-keyword">show</span> dbs<br>
          <span class="code-keyword">show</span> databases<br><br>
          
          <span class="code-comment">// Ho·∫∑c d√πng method</span><br>
          db.<span class="code-method">adminCommand</span>({ listDatabases: <span class="code-number">1</span> })
        </div>

        <div class="section-title">‚ûï T·∫°o / Ch·ªçn Database</div>
        <div class="code-block">
          <span class="code-comment">// Ch·ªçn database (t·∫°o m·ªõi n·∫øu ch∆∞a t·ªìn t·∫°i)</span><br>
          <span class="code-keyword">use</span> myDatabase<br><br>
          
          <span class="code-comment">// Xem database hi·ªán t·∫°i</span><br>
          db<br>
          db.<span class="code-method">getName</span>()
        </div>
        <div class="info-box">
          üí° Database ch·ªâ th·ª±c s·ª± ƒë∆∞·ª£c t·∫°o khi c√≥ document ƒë·∫ßu ti√™n ƒë∆∞·ª£c insert v√†o collection.
        </div>

        <div class="section-title">üóëÔ∏è X√≥a Database</div>
        <div class="code-block">
          <span class="code-comment">// Ch·ªçn database c·∫ßn x√≥a tr∆∞·ªõc</span><br>
          <span class="code-keyword">use</span> myDatabase<br><br>
          
          <span class="code-comment">// X√≥a database hi·ªán t·∫°i</span><br>
          db.<span class="code-method">dropDatabase</span>()
        </div>
        <div class="warning-box">
          ‚ö†Ô∏è <strong>C·∫¢NH B√ÅO:</strong> dropDatabase() x√≥a vƒ©nh vi·ªÖn t·∫•t c·∫£ collections v√† data!
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-icon">üìä</span>
          <span class="card-title">Database Statistics & Info</span>
        </div>
        
        <div class="code-block">
          <span class="code-comment">// Th·ªëng k√™ database</span><br>
          db.<span class="code-method">stats</span>()<br><br>
          
          <span class="code-comment">// Output:</span><br>
          {<br>
          &nbsp;&nbsp;<span class="code-prop">"db"</span>: <span class="code-string">"myDatabase"</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"collections"</span>: <span class="code-number">5</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"views"</span>: <span class="code-number">0</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"objects"</span>: <span class="code-number">10000</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"avgObjSize"</span>: <span class="code-number">256</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"dataSize"</span>: <span class="code-number">2560000</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"storageSize"</span>: <span class="code-number">1048576</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"indexes"</span>: <span class="code-number">8</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"indexSize"</span>: <span class="code-number">524288</span><br>
          }
        </div>

        <div class="code-block">
          <span class="code-comment">// Server status</span><br>
          db.<span class="code-method">serverStatus</span>()<br><br>
          
          <span class="code-comment">// Host info</span><br>
          db.<span class="code-method">hostInfo</span>()<br><br>
          
          <span class="code-comment">// Version</span><br>
          db.<span class="code-method">version</span>()
        </div>

        <div class="code-block">
          <span class="code-comment">// Profiling level</span><br>
          db.<span class="code-method">getProfilingLevel</span>()<br>
          db.<span class="code-method">setProfilingLevel</span>(<span class="code-number">1</span>, { slowms: <span class="code-number">100</span> })
        </div>
      </div>
    </div>

    <!-- Collection Operations -->
    <div class="grid">
      <div class="card">
        <div class="card-header">
          <span class="card-icon">üìÅ</span>
          <span class="card-title">Collection - T·∫°o & Xem</span>
        </div>
        
        <div class="section-title">üìã Xem Collections</div>
        <div class="code-block">
          <span class="code-comment">// Li·ªát k√™ collections</span><br>
          <span class="code-keyword">show</span> collections<br>
          <span class="code-keyword">show</span> tables<br><br>
          
          <span class="code-comment">// D√πng method</span><br>
          db.<span class="code-method">getCollectionNames</span>()<br><br>
          
          <span class="code-comment">// Chi ti·∫øt h∆°n</span><br>
          db.<span class="code-method">getCollectionInfos</span>()
        </div>

        <div class="section-title">‚ûï T·∫°o Collection</div>
        <div class="code-block">
          <span class="code-comment">// C√°ch 1: T·∫°o ng·∫ßm ƒë·ªãnh (implicit)</span><br>
          db.users.<span class="code-method">insertOne</span>({ name: <span class="code-string">"John"</span> })<br>
          <span class="code-comment">// ‚Üí Collection "users" t·ª± ƒë·ªông ƒë∆∞·ª£c t·∫°o</span>
        </div>

        <div class="code-block">
          <span class="code-comment">// C√°ch 2: T·∫°o t∆∞·ªùng minh (explicit)</span><br>
          db.<span class="code-method">createCollection</span>(<span class="code-string">"products"</span>)<br><br>
          
          <span class="code-comment">// V·ªõi options</span><br>
          db.<span class="code-method">createCollection</span>(<span class="code-string">"logs"</span>, {<br>
          &nbsp;&nbsp;<span class="code-prop">capped</span>: <span class="code-bool">true</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">size</span>: <span class="code-number">5242880</span>,      <span class="code-comment">// 5MB</span><br>
          &nbsp;&nbsp;<span class="code-prop">max</span>: <span class="code-number">5000</span>            <span class="code-comment">// max documents</span><br>
          })
        </div>

        <div class="tip-box">
          ‚úÖ D√πng <code>createCollection()</code> khi c·∫ßn: Capped collection, Schema validation, ho·∫∑c custom options.
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-icon">üîß</span>
          <span class="card-title">Collection - S·ª≠a & X√≥a</span>
        </div>
        
        <div class="section-title">‚úèÔ∏è ƒê·ªïi T√™n Collection</div>
        <div class="code-block">
          <span class="code-comment">// ƒê·ªïi t√™n trong c√πng database</span><br>
          db.oldName.<span class="code-method">renameCollection</span>(<span class="code-string">"newName"</span>)<br><br>
          
          <span class="code-comment">// V·ªõi dropTarget (ghi ƒë√® n·∫øu t·ªìn t·∫°i)</span><br>
          db.oldName.<span class="code-method">renameCollection</span>(<span class="code-string">"newName"</span>, <span class="code-bool">true</span>)
        </div>

        <div class="section-title">üóëÔ∏è X√≥a Collection</div>
        <div class="code-block">
          <span class="code-comment">// X√≥a collection (v√† t·∫•t c·∫£ indexes)</span><br>
          db.users.<span class="code-method">drop</span>()<br><br>
          
          <span class="code-comment">// Ki·ªÉm tra tr∆∞·ªõc khi x√≥a</span><br>
          <span class="code-keyword">if</span> (db.<span class="code-method">getCollectionNames</span>().<span class="code-method">includes</span>(<span class="code-string">"users"</span>)) {<br>
          &nbsp;&nbsp;db.users.<span class="code-method">drop</span>()<br>
          }
        </div>

        <div class="section-title">üßπ X√≥a T·∫•t C·∫£ Documents (TRUNCATE)</div>
        <div class="code-block">
          <span class="code-comment">// X√≥a t·∫•t c·∫£ documents, gi·ªØ collection & indexes</span><br>
          db.users.<span class="code-method">deleteMany</span>({})<br><br>
          
          <span class="code-comment">// Ho·∫∑c (deprecated)</span><br>
          db.users.<span class="code-method">remove</span>({})
        </div>
        
        <div class="sql-mongo">
          <div class="sql-box">
            <div class="sql-box-title">SQL</div>
            <div class="mini-code">TRUNCATE TABLE users;</div>
          </div>
          <div class="mongo-box">
            <div class="mongo-box-title">MongoDB</div>
            <div class="mini-code">db.users.deleteMany({})</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Capped Collection -->
    <div class="grid">
      <div class="card">
        <div class="card-header">
          <span class="card-icon">üîÑ</span>
          <span class="card-title">Capped Collection</span>
        </div>
        <div class="highlight">
          Collection c√≥ k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh, t·ª± ƒë·ªông x√≥a documents c≈© nh·∫•t khi ƒë·∫ßy (FIFO)
        </div>
        
        <div class="code-block">
          <span class="code-comment">// T·∫°o Capped Collection</span><br>
          db.<span class="code-method">createCollection</span>(<span class="code-string">"logs"</span>, {<br>
          &nbsp;&nbsp;<span class="code-prop">capped</span>: <span class="code-bool">true</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">size</span>: <span class="code-number">10485760</span>,     <span class="code-comment">// 10MB (required)</span><br>
          &nbsp;&nbsp;<span class="code-prop">max</span>: <span class="code-number">10000</span>           <span class="code-comment">// max 10000 docs (optional)</span><br>
          })
        </div>

        <div class="code-block">
          <span class="code-comment">// Ki·ªÉm tra collection c√≥ ph·∫£i capped</span><br>
          db.logs.<span class="code-method">isCapped</span>()<br><br>
          
          <span class="code-comment">// Convert collection th∆∞·ªùng ‚Üí capped</span><br>
          db.<span class="code-method">runCommand</span>({<br>
          &nbsp;&nbsp;<span class="code-prop">convertToCapped</span>: <span class="code-string">"mycollection"</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">size</span>: <span class="code-number">10485760</span><br>
          })
        </div>

        <div class="flex-row">
          <span class="tag-green tag">‚úì Insert nhanh</span>
          <span class="tag-green tag">‚úì ƒê·ªçc theo th·ª© t·ª± insert</span>
          <span class="tag-green tag">‚úì T·ª± ƒë·ªông cleanup</span>
        </div>
        <div class="flex-row">
          <span class="tag-red tag">‚úó Kh√¥ng th·ªÉ delete</span>
          <span class="tag-red tag">‚úó Kh√¥ng th·ªÉ update size</span>
          <span class="tag-red tag">‚úó Kh√¥ng th·ªÉ shard</span>
        </div>

        <div class="info-box">
          üí° <strong>Use cases:</strong> Logging, caching, real-time analytics, message queues
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-icon">‚è∞</span>
          <span class="card-title">TTL Collection (Time-To-Live)</span>
        </div>
        <div class="highlight">
          T·ª± ƒë·ªông x√≥a documents sau m·ªôt kho·∫£ng th·ªùi gian
        </div>
        
        <div class="code-block">
          <span class="code-comment">// T·∫°o TTL Index - x√≥a sau 3600 gi√¢y (1 gi·ªù)</span><br>
          db.sessions.<span class="code-method">createIndex</span>(<br>
          &nbsp;&nbsp;{ <span class="code-prop">createdAt</span>: <span class="code-number">1</span> },<br>
          &nbsp;&nbsp;{ <span class="code-prop">expireAfterSeconds</span>: <span class="code-number">3600</span> }<br>
          )
        </div>

        <div class="code-block">
          <span class="code-comment">// Document s·∫Ω t·ª± ƒë·ªông b·ªã x√≥a sau 1 gi·ªù</span><br>
          db.sessions.<span class="code-method">insertOne</span>({<br>
          &nbsp;&nbsp;<span class="code-prop">userId</span>: <span class="code-string">"user123"</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">token</span>: <span class="code-string">"abc..."</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">createdAt</span>: <span class="code-keyword">new</span> <span class="code-method">Date</span>()<br>
          })
        </div>

        <div class="code-block">
          <span class="code-comment">// TTL v·ªõi expireAt field c·ª• th·ªÉ</span><br>
          db.events.<span class="code-method">createIndex</span>(<br>
          &nbsp;&nbsp;{ <span class="code-prop">expireAt</span>: <span class="code-number">1</span> },<br>
          &nbsp;&nbsp;{ <span class="code-prop">expireAfterSeconds</span>: <span class="code-number">0</span> }<br>
          )<br><br>
          
          <span class="code-comment">// X√≥a v√†o th·ªùi ƒëi·ªÉm c·ª• th·ªÉ</span><br>
          db.events.<span class="code-method">insertOne</span>({<br>
          &nbsp;&nbsp;<span class="code-prop">event</span>: <span class="code-string">"sale"</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">expireAt</span>: <span class="code-keyword">new</span> <span class="code-method">Date</span>(<span class="code-string">"2024-12-31"</span>)<br>
          })
        </div>

        <div class="info-box">
          üí° <strong>Use cases:</strong> Sessions, cache, temporary data, logs rotation
        </div>
      </div>
    </div>

    <!-- Schema Validation -->
    <div class="grid">
      <div class="card full-width">
        <div class="card-header">
          <span class="card-icon">‚úÖ</span>
          <span class="card-title">Schema Validation ($jsonSchema)</span>
        </div>
        <div class="highlight">
          ƒê·ªãnh nghƒ©a rules ƒë·ªÉ validate documents khi insert/update - Gi·ªØ data integrity
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
          <div>
            <div class="section-title">üÜï T·∫°o Collection v·ªõi Validation</div>
            <div class="code-block">
              db.<span class="code-method">createCollection</span>(<span class="code-string">"users"</span>, {<br>
              &nbsp;&nbsp;<span class="code-prop">validator</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">$jsonSchema</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">bsonType</span>: <span class="code-string">"object"</span>,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">required</span>: [<span class="code-string">"name"</span>, <span class="code-string">"email"</span>, <span class="code-string">"age"</span>],<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">properties</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">name</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">bsonType</span>: <span class="code-string">"string"</span>,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">description</span>: <span class="code-string">"T√™n - required string"</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">email</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">bsonType</span>: <span class="code-string">"string"</span>,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">pattern</span>: <span class="code-string">"^.+@.+$"</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">age</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">bsonType</span>: <span class="code-string">"int"</span>,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">minimum</span>: <span class="code-number">0</span>,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">maximum</span>: <span class="code-number">150</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">status</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">enum</span>: [<span class="code-string">"active"</span>, <span class="code-string">"inactive"</span>, <span class="code-string">"pending"</span>]<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
              &nbsp;&nbsp;&nbsp;&nbsp;}<br>
              &nbsp;&nbsp;},<br>
              &nbsp;&nbsp;<span class="code-prop">validationLevel</span>: <span class="code-string">"strict"</span>,<br>
              &nbsp;&nbsp;<span class="code-prop">validationAction</span>: <span class="code-string">"error"</span><br>
              })
            </div>
          </div>
          
          <div>
            <div class="section-title">‚úèÔ∏è Th√™m/S·ª≠a Validation cho Collection c√≥ s·∫µn</div>
            <div class="code-block">
              db.<span class="code-method">runCommand</span>({<br>
              &nbsp;&nbsp;<span class="code-prop">collMod</span>: <span class="code-string">"users"</span>,<br>
              &nbsp;&nbsp;<span class="code-prop">validator</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">$jsonSchema</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">bsonType</span>: <span class="code-string">"object"</span>,<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">required</span>: [<span class="code-string">"name"</span>, <span class="code-string">"email"</span>],<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-prop">properties</span>: {<br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-comment">// ... schema definition</span><br>
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
              &nbsp;&nbsp;&nbsp;&nbsp;}<br>
              &nbsp;&nbsp;},<br>
              &nbsp;&nbsp;<span class="code-prop">validationLevel</span>: <span class="code-string">"moderate"</span><br>
              })
            </div>

            <div class="section-title">üìã Xem Validation Rules</div>
            <div class="code-block">
              db.<span class="code-method">getCollectionInfos</span>({ name: <span class="code-string">"users"</span> })
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Validation Options -->
    <div class="grid">
      <div class="card">
        <div class="card-header">
          <span class="card-icon">‚öôÔ∏è</span>
          <span class="card-title">Validation Level & Action</span>
        </div>
        
        <div class="section-title">validationLevel</div>
        <table class="comparison-table">
          <tr>
            <th>Level</th>
            <th>M√¥ t·∫£</th>
          </tr>
          <tr>
            <td><span class="tag-green tag">strict</span></td>
            <td>Validate t·∫•t c·∫£ inserts v√† updates (default)</td>
          </tr>
          <tr>
            <td><span class="tag-orange tag">moderate</span></td>
            <td>Ch·ªâ validate documents ƒë√£ valid tr∆∞·ªõc ƒë√≥</td>
          </tr>
          <tr>
            <td><span class="tag-red tag">off</span></td>
            <td>T·∫Øt validation</td>
          </tr>
        </table>

        <div class="section-title">validationAction</div>
        <table class="comparison-table">
          <tr>
            <th>Action</th>
            <th>M√¥ t·∫£</th>
          </tr>
          <tr>
            <td><span class="tag-red tag">error</span></td>
            <td>Reject document kh√¥ng valid (default)</td>
          </tr>
          <tr>
            <td><span class="tag-orange tag">warn</span></td>
            <td>Cho ph√©p insert nh∆∞ng log warning</td>
          </tr>
        </table>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-icon">üìù</span>
          <span class="card-title">$jsonSchema Properties</span>
        </div>
        
        <div class="code-block">
          <span class="code-comment">// C√°c bsonType ph·ªï bi·∫øn</span><br>
          <span class="code-string">"string"</span>, <span class="code-string">"int"</span>, <span class="code-string">"long"</span>, <span class="code-string">"double"</span>,<br>
          <span class="code-string">"decimal"</span>, <span class="code-string">"bool"</span>, <span class="code-string">"date"</span>, <span class="code-string">"objectId"</span>,<br>
          <span class="code-string">"array"</span>, <span class="code-string">"object"</span>, <span class="code-string">"null"</span>, <span class="code-string">"number"</span>
        </div>

        <table class="comparison-table">
          <tr>
            <th>Property</th>
            <th>M√¥ t·∫£</th>
          </tr>
          <tr>
            <td><code>bsonType</code></td>
            <td>Ki·ªÉu d·ªØ li·ªáu BSON</td>
          </tr>
          <tr>
            <td><code>required</code></td>
            <td>Array c√°c field b·∫Øt bu·ªôc</td>
          </tr>
          <tr>
            <td><code>properties</code></td>
            <td>ƒê·ªãnh nghƒ©a schema cho t·ª´ng field</td>
          </tr>
          <tr>
            <td><code>enum</code></td>
            <td>Gi·ªõi h·∫°n gi√° tr·ªã cho ph√©p</td>
          </tr>
          <tr>
            <td><code>minimum/maximum</code></td>
            <td>Gi·ªõi h·∫°n s·ªë</td>
          </tr>
          <tr>
            <td><code>minLength/maxLength</code></td>
            <td>Gi·ªõi h·∫°n ƒë·ªô d√†i string</td>
          </tr>
          <tr>
            <td><code>pattern</code></td>
            <td>Regex pattern cho string</td>
          </tr>
          <tr>
            <td><code>description</code></td>
            <td>M√¥ t·∫£ field</td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Views -->
    <div class="grid">
      <div class="card">
        <div class="card-header">
          <span class="card-icon">üëÅÔ∏è</span>
          <span class="card-title">Views (Read-Only)</span>
        </div>
        <div class="highlight">
          Virtual collection d·ª±a tr√™n aggregation pipeline - kh√¥ng l∆∞u data
        </div>
        
        <div class="code-block">
          <span class="code-comment">// T·∫°o View</span><br>
          db.<span class="code-method">createView</span>(<br>
          &nbsp;&nbsp;<span class="code-string">"activeUsers"</span>,        <span class="code-comment">// view name</span><br>
          &nbsp;&nbsp;<span class="code-string">"users"</span>,               <span class="code-comment">// source collection</span><br>
          &nbsp;&nbsp;[                         <span class="code-comment">// pipeline</span><br>
          &nbsp;&nbsp;&nbsp;&nbsp;{ <span class="code-keyword">$match</span>: { status: <span class="code-string">"active"</span> } },<br>
          &nbsp;&nbsp;&nbsp;&nbsp;{ <span class="code-keyword">$project</span>: { name: <span class="code-number">1</span>, email: <span class="code-number">1</span> } }<br>
          &nbsp;&nbsp;]<br>
          )
        </div>

        <div class="code-block">
          <span class="code-comment">// S·ª≠ d·ª•ng View nh∆∞ collection th∆∞·ªùng</span><br>
          db.activeUsers.<span class="code-method">find</span>()<br>
          db.activeUsers.<span class="code-method">findOne</span>({ name: <span class="code-string">"John"</span> })
        </div>

        <div class="code-block">
          <span class="code-comment">// X√≥a View</span><br>
          db.activeUsers.<span class="code-method">drop</span>()
        </div>

        <div class="flex-row">
          <span class="tag-green tag">‚úì Read-only</span>
          <span class="tag-green tag">‚úì Real-time data</span>
          <span class="tag-green tag">‚úì Security layer</span>
          <span class="tag-red tag">‚úó Kh√¥ng th·ªÉ write</span>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-icon">üìä</span>
          <span class="card-title">Collection Statistics</span>
        </div>
        
        <div class="code-block">
          <span class="code-comment">// Th·ªëng k√™ collection</span><br>
          db.users.<span class="code-method">stats</span>()<br><br>
          
          <span class="code-comment">// Output quan tr·ªçng:</span><br>
          {<br>
          &nbsp;&nbsp;<span class="code-prop">"ns"</span>: <span class="code-string">"mydb.users"</span>,<br>
          &nbsp;&nbsp;<span class="code-prop">"count"</span>: <span class="code-number">10000</span>,         <span class="code-comment">// s·ªë documents</span><br>
          &nbsp;&nbsp;<span class="code-prop">"size"</span>: <span class="code-number">2560000</span>,        <span class="code-comment">// data size (bytes)</span><br>
          &nbsp;&nbsp;<span class="code-prop">"avgObjSize"</span>: <span class="code-number">256</span>,     <span class="code-comment">// avg doc size</span><br>
          &nbsp;&nbsp;<span class="code-prop">"storageSize"</span>: <span class="code-number">1048576</span>, <span class="code-comment">// allocated</span><br>
          &nbsp;&nbsp;<span class="code-prop">"nindexes"</span>: <span class="code-number">3</span>,         <span class="code-comment">// s·ªë indexes</span><br>
          &nbsp;&nbsp;<span class="code-prop">"totalIndexSize"</span>: <span class="code-number">524288</span><br>
          }
        </div>

        <div class="code-block">
          <span class="code-comment">// ƒê·∫øm documents</span><br>
          db.users.<span class="code-method">countDocuments</span>({})<br>
          db.users.<span class="code-method">countDocuments</span>({ status: <span class="code-string">"active"</span> })<br><br>
          
          <span class="code-comment">// Estimated count (nhanh h∆°n)</span><br>
          db.users.<span class="code-method">estimatedDocumentCount</span>()
        </div>
      </div>
    </div>

    <!-- Quick Reference -->
    <div class="grid">
      <div class="card full-width">
        <div class="card-header">
          <span class="card-icon">‚ö°</span>
          <span class="card-title">Quick Reference - DDL Commands</span>
        </div>
        <table class="comparison-table">
          <tr>
            <th>M·ª•c ƒë√≠ch</th>
            <th>Command</th>
          </tr>
          <tr>
            <td>Xem databases</td>
            <td><code>show dbs</code></td>
          </tr>
          <tr>
            <td>Ch·ªçn/T·∫°o database</td>
            <td><code>use dbName</code></td>
          </tr>
          <tr>
            <td>X√≥a database</td>
            <td><code>db.dropDatabase()</code></td>
          </tr>
          <tr>
            <td>Xem collections</td>
            <td><code>show collections</code></td>
          </tr>
          <tr>
            <td>T·∫°o collection</td>
            <td><code>db.createCollection("name")</code></td>
          </tr>
          <tr>
            <td>X√≥a collection</td>
            <td><code>db.collection.drop()</code></td>
          </tr>
          <tr>
            <td>ƒê·ªïi t√™n collection</td>
            <td><code>db.col.renameCollection("newName")</code></td>
          </tr>
          <tr>
            <td>Truncate (x√≥a data)</td>
            <td><code>db.collection.deleteMany({})</code></td>
          </tr>
          <tr>
            <td>T·∫°o capped collection</td>
            <td><code>db.createCollection("name", {capped:true, size:...})</code></td>
          </tr>
          <tr>
            <td>T·∫°o TTL index</td>
            <td><code>db.col.createIndex({field:1}, {expireAfterSeconds:...})</code></td>
          </tr>
          <tr>
            <td>T·∫°o view</td>
            <td><code>db.createView("viewName", "source", [pipeline])</code></td>
          </tr>
          <tr>
            <td>Th√™m validation</td>
            <td><code>db.runCommand({collMod:"col", validator:{...}})</code></td>
          </tr>
          <tr>
            <td>Xem stats</td>
            <td><code>db.collection.stats()</code></td>
          </tr>
        </table>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p>üìö MongoDB Cheat Sheet Series | Part 3 of 16</p>
      <p>Created with Monica AI | December 2024</p>
    </div>
  </div>
</body>
</html>